version: "3.3"

services:
  api:
    image: baffedu/laravel:0.1-fpm
    volumes:
      - ${API_PATH}/supervisor.conf:/etc/supervisor.d/api.ini
      - ${API_PATH}:/var/www/html
    environment:
      - VIRTUAL_HOST=${API_HOST}
      - APP_MAIN_DB=${APP_MAIN_DB}
      - APP_IMPORT_DB=${APP_IMPORT_DB}
  app:
    image: nginx:1.15-alpine
    volumes:
      - ${APP_PATH}:/usr/share/nginx/html
    environment:
      - VIRTUAL_HOST=${APP_HOST}

# when telnet other service, you may need to configure firewalld
# docker network create --driver=bridge --subnet=10.50.0.0/16 baffedu
networks:
  default:
    external:
      name: baffedu